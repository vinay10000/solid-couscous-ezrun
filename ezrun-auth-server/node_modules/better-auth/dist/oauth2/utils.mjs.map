{"version":3,"file":"utils.mjs","names":[],"sources":["../../src/oauth2/utils.ts"],"sourcesContent":["import type { AuthContext } from \"@better-auth/core\";\nimport { symmetricDecrypt, symmetricEncrypt } from \"../crypto\";\n\nexport function decryptOAuthToken(token: string, ctx: AuthContext) {\n\tif (!token) return token;\n\tif (ctx.options.account?.encryptOAuthTokens) {\n\t\treturn symmetricDecrypt({\n\t\t\tkey: ctx.secret,\n\t\t\tdata: token,\n\t\t});\n\t}\n\treturn token;\n}\n\nexport function setTokenUtil(\n\ttoken: string | null | undefined,\n\tctx: AuthContext,\n) {\n\tif (ctx.options.account?.encryptOAuthTokens && token) {\n\t\treturn symmetricEncrypt({\n\t\t\tkey: ctx.secret,\n\t\t\tdata: token,\n\t\t});\n\t}\n\treturn token;\n}\n"],"mappings":";;;AAGA,SAAgB,kBAAkB,OAAe,KAAkB;AAClE,KAAI,CAAC,MAAO,QAAO;AACnB,KAAI,IAAI,QAAQ,SAAS,mBACxB,QAAO,iBAAiB;EACvB,KAAK,IAAI;EACT,MAAM;EACN,CAAC;AAEH,QAAO;;AAGR,SAAgB,aACf,OACA,KACC;AACD,KAAI,IAAI,QAAQ,SAAS,sBAAsB,MAC9C,QAAO,iBAAiB;EACvB,KAAK,IAAI;EACT,MAAM;EACN,CAAC;AAEH,QAAO"}